@{
    ViewBag.Title = "Play";
}

<h2>Play</h2>

<input type="hidden" id="gameId" name="gameId" value="@ViewBag.GameId" />

<div class="container play-container py-5">

    @{ Html.RenderAction("GetBoard", "Home", new { id = 1 }); }

</div>


@section scripts
{

    <script>



        //$(document).ready(function () {}
        //{
        //    $.get("/Home/GetPlayer2Form", function (data) {

        //        $('#jsPlayerFormContainer').html(data);

        //        initValidator("player2Form");

        //    });
        //}

        var currentPlayer = 1;
        var symbol = "X";

        $(document).on('click', '.square', function () {

            var square = $(this);

            if (square.find('div').html().length > 0) {
                toastr.error("Cannot overwrite move, try a different move.");
                return;
            }

            square.find('div').html(symbol);

            var currentRound = $('#currentRound').val();
            var gameId = $('#gameId').val();
            var blockId = square.attr('data-id'); //squares are numbered in left-to-right fashion

            toastr.info("CurrentRound = " + currentRound);
            toastr.info("Currentplayer = " + currentPlayer);


            //save move
            $.post("/Home/SaveMove/" + gameId + "/" + currentRound + "/" + currentPlayer + "/" + blockId, function (data) {

                if (data.resultCode == 1) {

                    toastr.success(data.data);
                }
                else {

                    toastr.error(data.data);
                }

            });


            if (currentPlayer == 1) {
                currentPlayer = 2;
                symbol = "O";
            }
            else {
                currentPlayer = 1;
                symbol = "X";
            }




        });

    </script>
}
